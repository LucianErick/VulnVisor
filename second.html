</script>
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script src="http://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
      <script>
function generateReportTitle(){document.getElementById("reportTitle").textContent=trivyData.ArtifactName}function generateReportType(){document.getElementById("reportType").textContent="filesystem"===trivyData.ArtifactType?"Module":"Image"}function renderCreatedAt(){document.getElementById("createdAt").textContent="Generated at: "+new Date(1e3*createdAt).toLocaleString()}function base(){var e;return trivyData?document.querySelector("#root")?(e=countVulnerabilitiesBySeverityAndType(trivyData),createSeverityChart(e),e=processTrivyData(trivyData),updatedMitigationsTable(e),e=countVulnerabilitiesByPackage(trivyData),createPackagesChart(e),fillVulnerabilityTable(trivyData),createPackagesTable(trivyData.Results),toggleTablesVisibility(),trivyData.Results&&fillSecretsContainer(getSecretsTable(trivyData.Results)),generateReportTitle(),generateReportType(),void renderCreatedAt()):console.error("Can't find root"):console.error("Report data not loaded")}document.addEventListener("DOMContentLoaded",base);
</script>
      <script>
function countVulnerabilitiesBySeverityAndType(e){e=e.Results;const n={};let o={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0};return e.forEach(e=>{const t=e.Type;n[t]||(n[t]={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0});e=e.Vulnerabilities;e&&e.forEach(e=>{e=e.Severity;n[t][e]++,o[e]++})}),{...n,total:o}}function updateTableWithCounts(e){var t=document.getElementById("groupSeverityBySource");for(const i in e)if(e.hasOwnProperty(i)){var n=e[i],o=t.insertRow(1),a=(o.insertCell(0).innerHTML=i,["LOW","MEDIUM","HIGH","CRITICAL"]);for(let e=0;e<a.length;e++){var r=a[e];o.insertCell(e+1).innerHTML=n[r]}}}function processTrivyData(e){let t={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0},n={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0},o={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0},a={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0};return e.Results.forEach(e=>{e.Vulnerabilities&&e.Vulnerabilities.forEach(e=>{e.Severity in t&&t[e.Severity]++,"affected"===e.Status?n[e.Severity]++:o[e.Severity]++,e.FixedVersion&&a[e.Severity]++})}),{SeverityCount:t,AffectedCount:n,NotAffectedCount:o,HasFixedVersionCount:a}}function sumObjValues(e){let t=0;return Object.values(e).forEach(e=>{t+=e}),t}function updateSpanValue(e,t){e=document.getElementById(e);e&&(e.textContent=t.toString())}function updatedMitigationsTable(n){["SeverityCount","NotAffectedCount","AffectedCount","HasFixedVersionCount"].forEach((e,t)=>{updateSpanValue("value"+(t+1),sumObjValues(n[e]))})}function createSeverityChart(n){const o=document.getElementById("vulnerabilityChart").getContext("2d");let a;var e=document.getElementById("sourceSelector");for(const r in n)"total"===r?e.innerHTML+=`<option value="${r}" selected>${r}</option>`:"undefined"!=r&&(e.innerHTML+=`<option value="${r}">${r}</option>`);function t(e){a&&a.destroy();var e=n[e],t=Object.keys(e),e=Object.values(e);a=new Chart(o,{type:"doughnut",data:{labels:t,datasets:[{data:e,backgroundColor:["rgba(38, 70, 83, 0.9)","rgba(233, 196, 106, 0.9)","rgba(244, 162, 97, 0.9)","rgba(231, 111, 81, 0.9)"]}]},options:{cutout:40,title:{display:!0},plugins:{legend:{position:"right",labels:{usePointStyle:!0,boxHeight:8,font:{size:10}}}}}})}t("total"),e.addEventListener("change",e=>{t(e.target.value)})}function countVulnerabilitiesByPackage(e){const t={};return e.Results.forEach(e=>{e.Vulnerabilities&&e.Vulnerabilities.forEach(e=>{e=e.PkgName;t[e]?t[e]++:t[e]=1})}),t}function sortAndFilterTop6(e){return Object.entries(e).sort((e,t)=>t[1]-e[1]).slice(0,6)}function createPackagesChart(e){var t=document.getElementById("packagesChart").getContext("2d");let n=[],o=[];sortAndFilterTop6(e).forEach(e=>{n.push(e[0]),o.push(e[1])}),new Chart(t,{type:"doughnut",data:{labels:n,datasets:[{data:o,backgroundColor:["rgba(255, 89, 94, 0.9)","rgba(255, 202, 58, 0.9)","rgba(138, 201, 38, 0.9)","rgba(25, 130, 196, 0.9)","rgba(106, 76, 147, 0.9)","rgba(255, 219, 150, 0.9)"]}]},options:{cutout:30,title:{display:!0},plugins:{legend:{position:"right",labels:{usePointStyle:!0,boxHeight:8,font:{size:12}}}}}})}
</script>
      <script>
function fillVulnerabilityTable(e){let a=[];e.Results&&e.Results.forEach(i=>{i.Vulnerabilities&&i.Vulnerabilities.forEach(e=>{e.Source=i.Type,a.push(e)})});const i=$("#vulnerabilityTable").DataTable({pageLength:10,data:[],columns:[{data:"Vulnerabilities.0.PkgName"},{data:"Vulnerabilities.0.Title"},{data:"Vulnerabilities.0.VulnerabilityID"},{data:"Vulnerabilities.0.InstalledVersion"},{data:"Vulnerabilities.0.FixedVersion"},{data:"Vulnerabilities.0.CVSS.nvd.V2Score"},{data:"Vulnerabilities.0.CVSS.nvd.V3Score"},{data:"Vulnerabilities.0.Severity"},{data:"Vulnerabilities.0.Source"}]});e.Results.forEach(e=>{e.Vulnerabilities&&e.Vulnerabilities.forEach(e=>{i.row.add({Vulnerabilities:{0:{PkgName:e.PkgName??"none",VulnerabilityID:e.VulnerabilityID??"none",InstalledVersion:e.InstalledVersion??"none",FixedVersion:e.FixedVersion??"none",CVSS:{nvd:{V2Score:e.CVSS.nvd?.V2Score||"none",V3Score:e.CVSS.nvd?.V3Score||"none"}},Title:e.Title??"none",Severity:e.Severity??"none",Source:e.Source??"none"}}})})}),i.draw()}
</script>
      <script>
function createPackagesTable(e){let s=[];e&&e.forEach(a=>{a.Packages&&a.Packages.forEach(e=>{e.Source=a.Type,e.Licenses||(e.Licenses=["none"]),s.push(e)})});const a=$("#packages-table").DataTable({pageLength:10,data:s,columns:[{data:"Name"},{data:"Version"},{data:"Source"},{data:"Licenses"}]});s.forEach(e=>{a.row.add({Name:e.Name??"",Version:e.Version??"",Licenses:e.Licenses?e.Licenses.join(", "):"",Source:e.Source??""}).draw()})}
</script>
      <script>
function getSecretsTable(e){let t=[];return e&&e.forEach(e=>{e.Secrets&&t.push(e)}),t}function fillSecretsContainer(e){const s=document.getElementById("secretsContainer"),i={LOW:"#264653",MEDIUM:"#e9c46a",HIGH:"#f4a261",CRITICAL:"#e76f51"};e.forEach(o=>{o.Secrets&&o.Secrets.forEach(e=>{var t=document.createElement("div"),n=(t.className="secret",document.createElement("div")),c=(n.className="secretInfo",document.createElement("span")),a=(c.id="secretTitle",c.textContent=e.Title,document.createElement("span")),r=(a.id="secretSeverity",a.textContent=e.Severity,a.style.color=i[e.Severity],document.createElement("span"));r.id="secretTarget",r.textContent=o.Target;const d=document.createElement("div");d.className="secretCodeContainer",e.Code?.Lines.forEach(e=>{var t=document.createElement("div"),n=(t.className="secretCodeLine",d.appendChild(t),document.createElement("span")),n=(n.id="secretCodeLineNumber",n.textContent=""+e.Number,t.appendChild(n),document.createElement("span"));n.id="secretCodeLineContent",e.Content&&(n.textContent=e.Content,t.appendChild(n)),e.IsCause&&(n.style.color="var(--link)")}),n.appendChild(c),n.appendChild(a),n.appendChild(r),t.appendChild(n),t.appendChild(d),s.appendChild(t)})})}
</script>
      <script>
function toggleTablesVisibility(){var e=document.getElementById("selectTypeTable"),l=document.getElementById("vulnerabilitiesTable"),t=document.getElementById("packagesTable"),s=document.getElementById("secretsContainer"),e=e.value;"vulnerabilities"===e?(l.style.display="block",t.style.display="none",s.style.display="none"):"packages"===e?(l.style.display="none",t.style.display="block",s.style.display="none"):"secrets"===e&&(l.style.display="none",t.style.display="none",s.style.display="block")}const selectTypeTable=document.getElementById("selectTypeTable");selectTypeTable.addEventListener("change",toggleTablesVisibility);
</script>
    </div>
  </body>
</html>