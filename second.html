</script>
      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script>
function base(){var e;return trivyData?document.querySelector("#root")?(e=countVulnerabilitiesBySeverityAndType(trivyData),createSeverityChart(e),e=processTrivyData(trivyData),populateVulnerabilityMitigationsTable(e,"mitigatedVulnerabilityTable"),e=countVulnerabilitiesByPackage(trivyData),createBarChart(e),void renderCreatedAt()):console.error("Can't find root"):console.error("Report data not loaded")}document.addEventListener("DOMContentLoaded",base);
</script>
      <script>
function countVulnerabilitiesBySeverityAndType(e){e=e.Results;const n={};return e.forEach(e=>{const t=e.Type;n[t]||(n[t]={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0});e=e.Vulnerabilities;e&&e.forEach(e=>{e=e.Severity;n[t][e]++})}),n}function updateTableWithCounts(e){var t=document.getElementById("groupSeverityBySource");for(const o in e)if(e.hasOwnProperty(o)){var n=e[o],r=t.insertRow(1),i=(r.insertCell(0).innerHTML=o,["LOW","MEDIUM","HIGH","CRITICAL"]);for(let e=0;e<i.length;e++){var a=i[e];r.insertCell(e+1).innerHTML=n[a]}}}function processTrivyData(e){let t={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0},n={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0},r={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0},i={LOW:0,MEDIUM:0,HIGH:0,CRITICAL:0};return e.Results.forEach(e=>{e.Vulnerabilities&&e.Vulnerabilities.forEach(e=>{e.Severity in t&&t[e.Severity]++,"affected"===e.Status?n[e.Severity]++:r[e.Severity]++,e.FixedVersion&&i[e.Severity]++})}),{SeverityCount:t,AffectedCount:n,NotAffectedCount:r,HasFixedVersionCount:i}}function createSeverityChart(a){document.addEventListener("DOMContentLoaded",function(){const r=document.getElementById("vulnerabilityChart").getContext("2d");let i;t("total");var e=document.getElementById("sourceSelector");for(const n in a)e.innerHTML+=`<option value="${n}">${n}</option>`;function t(e){i&&i.destroy();var t=a[e],n=Object.keys(t),t=Object.values(t);i=new Chart(r,{type:"doughnut",data:{labels:n,datasets:[{data:t,backgroundColor:["rgba(255, 99, 132, 0.7)","rgba(255, 159, 64, 0.7)","rgba(255, 205, 86, 0.7)","rgba(75, 192, 192, 0.7)"]}]},options:{title:{display:!0,text:"Vulnerabilities by Severity - "+e}}})}e.addEventListener("change",e=>{t(e.target.value)})})}function populateVulnerabilityMitigationsTable(e,t){var t=document.getElementById(t),n=document.createElement("table"),r=n.createTHead(),i=n.createTBody(),a={SeverityCount:"Total",AffectedCount:"Unmitigated",NotAffectedCount:"Mitigated",HasFixedVersionCount:"Fix available"},o=r.insertRow();o.insertCell().textContent="Severity";for(const s in e)o.insertCell().textContent=a[s];for(const u in e.SeverityCount){var l=i.insertRow();l.insertCell().textContent=u;for(const c in e)l.insertCell().textContent=e[c][u]}t.appendChild(n)}function countVulnerabilitiesByPackage(e){const t={};return e.Results.forEach(e=>{e.Vulnerabilities&&e.Vulnerabilities.forEach(e=>{e=e.PkgName;t[e]?t[e]++:t[e]=1})}),t}function createBarChart(e){var t=Object.keys(e),e=Object.values(e),n=document.getElementById("barChart").getContext("2d");new Chart(n,{type:"bar",data:{labels:t,datasets:[{label:"Vulnerabilities found",data:e,backgroundColor:["rgba(75, 192, 192, 0.5)","rgba(255, 99, 132, 0.5)","rgba(255, 206, 86, 0.5)","rgba(54, 162, 235, 0.5)","rgba(153, 102, 255, 0.5)","rgba(255, 159, 64, 0.5)"],borderWidth:0}]},options:{plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,grid:{display:!1}},x:{grid:{display:!1}}}}})}
</script>
    </div>
  </body>
</html>