</script>
    <script>
const reportTitleTemplate=document.querySelector("#report-title"),tableTemplate=document.querySelector("#table"),tableRowTemplate=document.querySelector("#table-row"),vulnLinkTemplate=document.querySelector("#vuln-link"),emptyVulnsTemplate=document.querySelector("#empty-vuln-header"),topVulnTemplate=document.querySelector("#top-vuln"),miscTableRowTemplate=document.querySelector("#misc-table-row"),mistTableTemplate=document.querySelector("#misc-table"),emptyMiscTemplate=document.querySelector("#empty-misc-header"),topMiscTemplate=document.querySelector("#top-misc"),secretResultsTemplate=document.querySelector("#secret-results"),secretTemplate=document.querySelector("#secret"),secretCodeLineTemplate=document.querySelector("#secret__code-line"),resultContainerTemplate=document.querySelector("#result-container"),pkgTableTemplateTemplate=document.querySelector("#pkgs-table"),tableHeadCellTemplate=document.querySelector("#table-head-cell"),tableBodyRowTemplate=document.querySelector("#table-body-row"),tableBodyCellTemplate=document.querySelector("#table-body-cell"),dependencyTreeRootTemplate=document.querySelector("#dependency-tree"),dependencyTreeNodeTemplate=document.querySelector("#dependency-tree-node");
</script>
    <script>
function fillSecrets(o){var e=secretResultsTemplate.content.cloneNode(!0),t=e.querySelector(".secret-results__content"),r=e.querySelector(".secret-results__title");r.querySelector(".secret-results__title-target").textContent=o.Target;r.querySelector(".secret-results__title-class").textContent=`(${o.Class})`;r=o.Secrets.map(e=>{var t=secretTemplate.content.cloneNode(!0),r=t.querySelector(".secret__title"),n=t.querySelector(".secret__head"),c=t.querySelector(".secret__src"),s=t.querySelector(".secret__code"),l=n.querySelector(".secret__severity");l.classList.toggle("severity-"+e.Severity),l.textContent=e.Severity,n.querySelector(".secret__type").textContent=`${e.Category} (${e.RuleID})`,r.textContent=e.Title,c.querySelector(".secret__src-file").textContent=o.Target;c.querySelector(".secret__src-lines").textContent=e.StartLine===e.EndLine?e.StartLine:e.StartLine+" - "+e.EndLine;l=e.Code.Lines.map(e=>{var t=secretCodeLineTemplate.content.cloneNode(!0),r=t.querySelector(".secret__line");return r.querySelector(".secret__line-number").textContent=e.Number.toString(),r.querySelector(".secret__line-code pre").textContent=e.Content,e.IsCause&&r.classList.toggle("secret__line-cause"),t});return s.append(...l),t});return t.append(...r),e}
</script>
    <script>
function getEmptyResult(){var e=tableTemplate.content.cloneNode(!0),t=e.querySelector("tbody"),n=emptyVulnsTemplate.content.cloneNode(!0);return t.append(n),e}function getResultTablesByResults(e){var t,n,l=[],r=[];for(const o of e)o.Vulnerabilities&&o.Vulnerabilities.length?(t=fillResults(o),l.push(t)):o.Secrets&&o.Secrets.length?(t=fillSecrets(o),r.push(t)):(n=getEmptyResult(),l.push(n));return{resultTables:l,secretsTables:r}}function fillVulnerabilitiesTable(e){var t=tableTemplate.content.cloneNode(!0),n=t.querySelector(".header__title");const r=t.querySelector("tbody");return e.Vulnerabilities.forEach(t=>{const n=tableRowTemplate.content.cloneNode(!0);n.querySelector(".pkg-name").textContent=t.PkgName,n.querySelector(".vuln").textContent=t.VulnerabilityID,Object.keys(t.CVSS).map(e=>{e=t.CVSS[e];n.querySelector(".v2-score").textContent=e.V2Score??0,n.querySelector(".v3-score").textContent=e.V3Score??0}),n.querySelector(".vuln-title").textContent=t.Title,n.querySelector(".severity").textContent=t.Severity,n.querySelector(".pkg-version").textContent=t.InstalledVersion;const l=n.querySelector(".links");t.References&&t.References.forEach(e=>{var t=vulnLinkTemplate.content.cloneNode(!0).querySelector("a");t.href=e,t.textContent=e,l.append(t)}),r.append(n)}),n.textContent=e.Type,t}
</script>
    <script>
function getMiscResultTables(e){return e.Results.map(e=>{var t=mistTableTemplate.content.cloneNode(!0),n=t.querySelector(".header__title");const o=t.querySelector("tbody");return e.Misconfigurations&&e.Misconfigurations.length?(e.Misconfigurations.forEach(e=>{var t=miscTableRowTemplate.content.cloneNode(!0);t.querySelector(".misc-type").textContent=e.Type,t.querySelector(".misc-id").textContent=e.ID,t.querySelector(".misc-check").textContent=e.Title,t.querySelector(".misc-sev").textContent=e.Severity,t.querySelector(".misc-msg").textContent=e.Message,o.append(t)}),n.textContent=e.Type):(n=emptyMiscTemplate.content.cloneNode(!0),o.append(n)),t})}function getTopMiscResultTables(){return trivyData.Misconfigurations.map(e=>{var t=topMiscTemplate.content.cloneNode(!0),n=t.querySelector(".tables-container"),e=(t.querySelector("h2").textContent=`${e.Name} (${e.Kind})`,getMiscResultTables(e,mistTableTemplate,emptyMiscTemplate,miscTableRowTemplate));return n.append(...e),t})}
</script>
    <script>
const pkgKeys={ID:{dataType:"string",dataSortable:!0,classes:[]},Name:{dataType:"string",dataSortable:!0,classes:["break-word","pkg-key-name"]},Version:{dataType:"string",dataSortable:!0,classes:["ta-center","break-word","pkg-key-version"]},SrcName:{dataType:"string",dataSortable:!0,classes:["break-word","pkg-key-src-name"]},SrcVersion:{dataType:"string",dataSortable:!0,classes:["break-word","pkg-key-src-version"]}};function fillPkgTableHeadAndGetAvailableKeys(e,a){const l=[],r=[];return e.forEach(e=>{var a,t;pkgKeys[e]&&(l.push(e),a=(t=tableHeadCellTemplate.content.cloneNode(!0)).querySelector("th"),t=t.querySelector(".table-head-cell__content"),a.dataset.type=pkgKeys[e].dataType,a.dataset.sortable=pkgKeys[e].dataSortable,t.textContent=e,r.push(a))}),a.append(...r),l}function fillPkgTable(e){var a=pkgTableTemplateTemplate.content.cloneNode(!0),t=a.querySelector("tbody"),l=a.querySelector("thead tr");const r=fillPkgTableHeadAndGetAvailableKeys(Object.keys(e.Packages[0]),l);return{pkgTable:a,pkgTableBody:t,pkgTableRows:e.Packages.map(l=>{var e=tableBodyRowTemplate.content.cloneNode(!0),a=e.querySelector("tr"),t=r.map(e=>{var a=tableBodyCellTemplate.content.cloneNode(!0),t=a.querySelector("td");return l[e]&&(t.textContent=l[e],pkgKeys[e].classes)&&t.classList.add(...pkgKeys[e].classes),a});return a.append(...t),e})}}
</script>
    <script>
const SeverityNames=["UNKNOWN","LOW","MEDIUM","HIGH","CRITICAL"];function reverseDeps(e){var n={};for(const t of e)if(t.DependsOn)for(const d of t.DependsOn)n[d]?n[d].push(t.ID):n[d]=[t.ID];for(const r in n)n[r]=[...new Set(n[r])];return n}function summarize(t){let d=0;var e=SeverityNames.map(e=>{var n=t[e]??0,e=e+": "+n;return d+=n,e});return[d,e]}class Node{value="";nodes=[];constructor(e=""){this.value=e}addBranch(e){e=new Node(e);return this.nodes.push(e),e}findDeepestNodes(n=0){if(!this.nodes||0===this.nodes.length)return[{node:this,depth:n}];var e=this.nodes.map(e=>e.findDeepestNodes(n+1)).reduce((e,n)=>e.concat(n),[]);const t=e.reduce((e,{depth:n})=>Math.max(e,n),n);return e.filter(({depth:e})=>e===t)}}function addParents(e,n,t,d){d[n]=!0;for(const r of t[n]||[]){if(d[r])return;addParents(e.addBranch(r),r,t,d)}}function buildDependencyTree(e){var n=reverseDeps(e.Packages);if(0!==Object.keys(n).length){var t,d={};for(t of e.Vulnerabilities){var r=d[t.PkgID]||{};r[t.Severity]=(r[t.Severity]||0)+1,d[t.PkgID]=r}var o,c=new Node(e.Target),a=new Set;for(const i of e.Vulnerabilities)a.has(i.PkgID)||(o=summarize(d[i.PkgID]),o=i.PkgID+" ("+o.join(", ")+")",a.add(i.PkgID),addParents(c.addBranch(o),i.PkgID,n,{}));return c}}function fillDependencyTree(e){var n,t=dependencyTreeRootTemplate.content.cloneNode(!0),d=t.querySelector(".tree"),e=(t.querySelector(".dependency-tree__title").textContent=e.Target,buildDependencyTree(e));return e?(e=buildDependencyTreeDOM(e).map(e=>{var n,t,d,r,o=e.node.findDeepestNodes();return 2<o[0].depth&&(n=(t=e.nodeDOM.querySelector(".dependency-tree-node__container")).children.item(2),t.children.item(1).classList.add("hidden"),r=(t=dependencyTreeNodeTemplate.content.cloneNode(!0)).querySelector(".dependency-tree-node__title"),d=t.querySelector(".dependency-tree-node__children"),r.textContent="...",r.classList.add("dependency-tree-node__dots"),r=o.map(e=>{var n=dependencyTreeNodeTemplate.content.cloneNode(!0);return n.querySelector(".dependency-tree-node__title").textContent=e.node.value,n}),d.append(...r),n.append(t)),e.nodeDOM}),(n=dependencyTreeNodeTemplate.content.cloneNode(!0)).querySelector(".dependency-tree-node__children.original").append(...e),d.append(n),t):[]}function buildDependencyTreeDOM(e,r=0){return r++,e.nodes.map(e=>{var n=dependencyTreeNodeTemplate.content.cloneNode(!0),t=n.querySelector(".dependency-tree-node__title"),d=n.querySelector(".dependency-tree-node__children.original");return t.textContent=e.value,d.append(...buildDependencyTreeDOM(e,r)),1===r?{node:e,nodeDOM:n}:n})}
</script>
    <script>
function fillResults(e){var t,r,l=resultContainerTemplate.content.cloneNode(!0),n=l.querySelector(".tables"),a=args.split(" "),i=a.includes("--list-all-pkgs"),a=a.includes("--dependency-tree");return e.Vulnerabilities&&(t=fillVulnerabilitiesTable(e),n.append(t)),e.Packages&&(i&&({pkgTable:t,pkgTableBody:i,pkgTableRows:r}=fillPkgTable(e),i.append(...r),n.append(t)),a)&&(i=fillDependencyTree(e),n.append(i)),l}function renderCreatedAt(){if(!createdAt)return console.error("Creation timestamp not loaded");var e=document.querySelector("#title-time");e.innerHTML=new Date(1e3*createdAt).toLocaleString(),document.title+=" "+e.innerHTML}function getReportTitle(e){return e.Results?e.Results[0].Target:e.Vulnerabilities?e.Vulnerabilities[0].Name:void 0}function getTopVulnerabilities(){return trivyData.Vulnerabilities.map(e=>{var t=topVulnTemplate.content.cloneNode(!0),r=t.querySelector(".tables-container"),e=(t.querySelector("h2").textContent=`${e.Name} (${e.Kind})`,getResultTablesByResults(e.Results))["resultTables"];return r.append(...e),t})}function base(){var e,t,r;return trivyData?(e=document.querySelector("#root"))?(reportTitleTemplate.querySelector(".report-title__target").textContent=getReportTitle(trivyData),trivyData.Results?({resultTables:t,secretsTables:r}=getResultTablesByResults(trivyData.Results),t&&e.append(...t),r&&e.append(...r)):trivyData.Vulnerabilities&&(t=getTopVulnerabilities(),e.append(...t)),trivyData.Misconfigurations&&(r=getTopMiscResultTables(),e.append(...r)),void renderCreatedAt()):console.error("Can't find root"):console.error("Report data not loaded")}document.addEventListener("DOMContentLoaded",base);
</script>
    <script>
function insertAfter(e,t){e.parentNode.insertBefore(t,e.nextSibling)}const severityOrder={UNKNOWN:{order:5},LOW:{order:4},MEDIUM:{order:3},HIGH:{order:2},CRITICAL:{order:1}};function attachLinksInteractivity(){document.querySelectorAll("td.links").forEach(function(r){const n=[].concat.apply([],r.querySelectorAll("a"));[].sort.apply(n,function(e,t){return e.href>t.href?1:-1}),n.forEach(function(e,t){0<n.length&&0===t&&((t=document.createElement("a")).innerText="Toggle more links",t.href="#toggleMore",t.setAttribute("class","toggle-more-links"),r.appendChild(t)),r.appendChild(e)})}),document.querySelectorAll("a.toggle-more-links").forEach(function(t){t.onclick=function(){var e=t.parentElement.getAttribute("data-more-links");return t.parentElement.setAttribute("data-more-links","on"===e?"off":"on"),!1}})}function attachFilterInteractivity(){var e=document.querySelector(".filter_bar").querySelector(".filter_bar__filter_name");const t=document.querySelectorAll(".filterable"),n=[".pkg-name",".vuln",".vuln-title",".v2-score",".v3-score",".severity",".pkg-version",".pkg-key-name",".pkg-key-version",".pkg-key-src-name",".pkg-key-src-version"];e.addEventListener("keyup",e=>{var r;r=e.target.value,t.forEach(t=>{var e=n.map(e=>t.querySelector(e)).filter(e=>null!==e).map(e=>e.textContent||e.innerText).some(e=>e.toUpperCase().includes(r.toUpperCase()));t.style.display=e?"":"none"})})}function attachSortInteractivity(){let s=-1;const u=document.querySelectorAll("table");u.forEach((e,d)=>{e.addEventListener("click",e=>{e.stopPropagation();var e=e.target,t=e.getAttribute("data-type"),r="true"===e.getAttribute("data-sortable");if("TH"===e.nodeName&&r){r=e.cellIndex;{e=d;var n=r;var a=t;var o=s===r;e=u[e];const c=e.querySelector('tbody[data-main="true"]');t=e.querySelector("thead");const l=e=>o?-e:e;var i=Array(...c.rows);i.sort((e,t)=>{var e=e.cells[n].innerHTML,t=t.cells[n].innerHTML;return"string"===a?e<t?l(-1):t<e?l(1):0:"severity"===a?(e=severityOrder[e].order)<(t=severityOrder[t].order)?l(-1):t<e?l(1):0:void 0}),e.removeChild(c),i.forEach(e=>{c.appendChild(e)}),insertAfter(t,c)}s=s===r?-1:r}})})}function attachDependencyTreeInteractivity(){document.querySelectorAll(".dependency-tree-node__dots").forEach(e=>{e.addEventListener("click",()=>{var t=e.closest(".tree > li > ul.dependency-tree-node__children.original > .dependency-tree-node__container");let r,n;for(let e=0;e<t.children.length;e++)t.children[e].classList.contains("original")?r=t.children[e]:t.children[e].classList.contains("collapsed")&&(n=t.children[e]);r.classList.remove("hidden"),n.classList.add("hidden")})})}document.addEventListener("DOMContentLoaded",()=>{attachLinksInteractivity(),attachSortInteractivity(),attachFilterInteractivity(),attachDependencyTreeInteractivity()});
</script>
  </body>
</html>